<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="New Javascript direction">




  <meta name="keywords" content="programming,nodejs,javascript,">




  <link rel="alternate" href="/atom.xml" title="hello world">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.0">



<link rel="canonical" href="http://kflu.github.io/2016/03/23/2016-03-23-new-js-pattern/">


<meta name="description" content="This is to quickly summerize my recent thinking into using JS. There&apos;re many options, coffeescript, typescript, even livescript. Liked all of them. But I in general like something plain. So this suite">
<meta name="keywords" content="programming,nodejs,javascript">
<meta property="og:type" content="article">
<meta property="og:title" content="New Javascript direction">
<meta property="og:url" content="http://kflu.github.io/2016/03/23/2016-03-23-new-js-pattern/index.html">
<meta property="og:site_name" content="hello world">
<meta property="og:description" content="This is to quickly summerize my recent thinking into using JS. There&apos;re many options, coffeescript, typescript, even livescript. Liked all of them. But I in general like something plain. So this suite">
<meta property="og:updated_time" content="2024-06-20T04:41:55.622Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="New Javascript direction">
<meta name="twitter:description" content="This is to quickly summerize my recent thinking into using JS. There&apos;re many options, coffeescript, typescript, even livescript. Liked all of them. But I in general like something plain. So this suite">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.0">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




  



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    <title> New Javascript direction Â· hello world </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">hello world</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            home
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            about
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            archives
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            tags
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/atom.xml">
            rss
          </a>
        </li>
      
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">hello world</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        home
      </a>
    
      
      <a class="mobile-menu-item" href="/about">
        about
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        archives
      </a>
    
      
      <a class="mobile-menu-item" href="/tags">
        tags
      </a>
    
      
      <a class="mobile-menu-item" href="/atom.xml">
        rss
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          New Javascript direction
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Mar 23, 2016
        </span>
      </div>
    </header>

    

    <div class="post-content">
      
        <p>This is to quickly summerize my recent thinking into using JS. There're many options, coffeescript, typescript, even livescript. Liked all of them. But I in general like something plain. So this suites me better:</p>
<ul>
<li>Babel to enable ES6 and ES7 (async-await)</li>
<li>bluebird to promisify Node APIs</li>
</ul>
<p>This generally solves the problem of callback hell. Promises was a step further. But ultimately it comes to async-await. I'm not too worried about type safety, which TypeScript provides. But the requirement of <code>.d.ts</code> declarations scared me away. No thank you. Maybe later.</p>
<p>In <code>.babelrc</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;presets&quot;: [&quot;es2015&quot;],</span><br><span class="line">  &quot;plugins&quot;: [&quot;syntax-async-functions&quot;,&quot;transform-regenerator&quot;],</span><br><span class="line">  &quot;sourceMaps&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In <code>package.json</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;awesome-async&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;github.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;babel-plugin-syntax-async-functions&quot;: &quot;^6.1.4&quot;,</span><br><span class="line">    &quot;babel-plugin-transform-regenerator&quot;: &quot;^6.1.4&quot;,</span><br><span class="line">    &quot;babel-polyfill&quot;: &quot;^6.1.4&quot;,</span><br><span class="line">    &quot;babel-preset-es2015&quot;: &quot;^6.1.4&quot;,</span><br><span class="line">    &quot;bluebird&quot;: &quot;^3.3.4&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In <code>test.es6</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">require(&apos;babel-polyfill&apos;);</span><br><span class="line">var Promise = require(&apos;bluebird&apos;);</span><br><span class="line">var fs = Promise.promisifyAll(require(&quot;fs&quot;));</span><br><span class="line"></span><br><span class="line">async function read(p) &#123;</span><br><span class="line">    var data = await fs.readFileAsync(p, &apos;utf8&apos;);</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">     * data is the actual file content. You can print it:</span><br><span class="line">     *</span><br><span class="line">     * 		console.log(data);</span><br><span class="line">     *</span><br><span class="line">     * But if it&apos;s returned from this function, it&apos;s wrapped</span><br><span class="line">     * into a Promise</span><br><span class="line">     */</span><br><span class="line">    return data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * async functions return Promises!!!</span><br><span class="line"> *</span><br><span class="line"> * Note: you can&apos;t await outside of async:</span><br><span class="line">     var data = await read(&apos;package.json&apos;);</span><br><span class="line"> */</span><br><span class="line">read(&apos;package.json&apos;).then(console.log);</span><br></pre></td></tr></table></figure>
<p>Now run:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; babel test.es6 -o test.js --source-maps</span><br><span class="line">&gt; node test.js</span><br></pre></td></tr></table></figure>
<p>Note that async await needs polyfill the app, and hence the <code>require('babel-polyfill');</code> statement at the beginning of the script. Note that polyfill only needs to be done once for the app. So if you don't want to pollute the business logic code base, write a opt-level wrapper to polyfill and call the actuall logic.</p>

      
    </div>

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/programming/">programming</a>
          
            <a href="/tags/nodejs/">nodejs</a>
          
            <a href="/tags/javascript/">javascript</a>
          
        </div>

        
  <nav class="post-nav">
    
      <a class="prev" href="/2016/03/24/2016-03-24-setup-iis-nodejs-enterprise/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Deploy Node.js web app with Enterprise Network Authentication</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2016/03/23/2016-03-23-Deploying-Node-App-On-Windows/">
        <span class="next-text nav-default">Deploying Node App On Windows</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2005 - 
    
    2024

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">KL</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    

  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://kflu.github.io/2016/03/23/2016-03-23-new-js-pattern/';
        this.page.identifier = '2016/03/23/2016-03-23-new-js-pattern/';
        this.page.title = 'New Javascript direction';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//codefun.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.0"></script>

  </body>
</html>